<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <!-- –í–∏–º–∫–Ω—É—Ç–∏ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è (pinch / double-tap zoom) –∑–∞ –∑–∞–ø–∏—Ç–æ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <title>YutFurry - YouTube –∫–ª—ñ—î–Ω—Ç (–∞–¥–∞–ø—Ç–æ–≤–∞–Ω–æ)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body {
            height: 100%;
            -webkit-text-size-adjust: 100%;
            touch-action: manipulation; /* –∑–Ω–∏–∂—É—î –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –Ω–µ–±–∞–∂–∞–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è/–∂–µ—Å—Ç—ñ–≤ */
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0f0f0f;
            color: #ffffff;
            line-height: 1.5;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
        }

    /* layout */
    .container { display: flex; min-height: 100vh; }

    /* Sidebar */
    .sidebar {
        width: 240px;
        background-color: #0f0f0f;
        padding: 12px;
        position: fixed;
        height: 100vh;
        overflow-y: auto;
        border-right: 1px solid #272727;
        transition: transform 0.25s ease;
        z-index: 30;
    }

    .logo { display:flex; align-items:center; padding: 0 12px; margin-bottom: 20px; }
    .logo-icon{
        background: linear-gradient(45deg, #ff0000, #ff6b6b);
        color:white; width:40px;height:40px;border-radius:8px;
        display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:18px;margin-right:12px;
    }
    .logo-text{
        font-size:20px;font-weight:bold;
        background:linear-gradient(45deg,#ff0000,#ff6b6b);
        -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    }

    .nav-section { margin-bottom: 24px; }
    .nav-title { padding: 8px 24px; font-size:14px; color:#aaa; text-transform:uppercase; letter-spacing:0.5px; }
    .nav-item {
        display:flex; align-items:flex-start; gap:12px;
        padding: 10px 24px; border-radius:12px; cursor:pointer; transition: all .2s ease; margin-bottom:6px;
    }
    .nav-item:hover { background:#272727; }
    .nav-item.active { background:#272727; }
    .nav-icon { width:24px; height:24px; display:flex; align-items:center; justify-content:center; }

    /* main content */
    .main-content { flex:1; margin-left:240px; padding: 20px 16px 120px 16px; } /* bottom padding for mobile bottom nav */

    /* search */
    .top-search {
        display:none; /* shown on mobile */
        position:fixed;
        top:0; left:0; right:0;
        height:56px;
        background:#0f0f0f; border-bottom:1px solid #272727;
        z-index:40;
        display:flex; align-items:center; gap:12px; padding:8px 12px;
    }
    .top-search .logo-icon-small{ width:36px; height:36px; border-radius:6px; display:flex; align-items:center; justify-content:center; font-weight:bold; font-size:16px; }
    .search-container {
        display:flex; align-items:center; background:#272727; border-radius:24px; padding:8px 12px; max-width:720px; width:100%;
    }
    .search-input { flex:1; background:transparent; border:none; color:white; font-size:16px; padding:6px 8px; outline:none; }
    .search-button { background:#373737; border:none; color:white; padding:8px 12px; border-radius:20px; cursor:pointer; }

    /* categories */
    .categories { display:flex; gap:12px; margin:16px 0 20px 0; flex-wrap:nowrap; overflow-x:auto; padding-bottom:6px; }
    .category { background:#373737; padding:8px 14px; border-radius:20px; cursor:pointer; font-size:14px; white-space:nowrap; }
    .category.active { background:white; color:black; }

    /* video grid (desktop) */
    .video-grid {
        display:grid;
        grid-template-columns: repeat(auto-fill, minmax(320px,1fr));
        gap:20px;
        margin-bottom:40px;
    }
    .video-card {
        background:#1a1a1a; border-radius:12px; overflow:hidden; transition: transform .25s, box-shadow .25s; cursor:pointer;
    }
    .video-card:hover{ transform:translateY(-4px); box-shadow:0 8px 24px rgba(255,255,255,0.03); }
    .thumbnail { width:100%; height:180px; background:#373737; position:relative; overflow:hidden; }
    .thumbnail img{ width:100%; height:100%; object-fit:cover; display:block; }
    .duration { position:absolute; bottom:8px; right:8px; background:rgba(0,0,0,0.8); padding:2px 6px; border-radius:4px; font-size:12px; }

    .video-info { padding:12px; }
    .video-title { font-weight:600; margin-bottom:8px; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
    .channel-info { display:flex; align-items:center; margin-bottom:4px; gap:12px; }
    .channel-avatar { width:36px; height:36px; border-radius:50%; background:#373737; overflow:hidden; flex-shrink:0; }
    .channel-avatar img{ width:100%; height:100%; object-fit:cover; }
    .channel-name{ color:#aaa; font-size:14px; }
    .video-stats{ color:#aaa; font-size:14px; margin-left:48px; }

    /* modal */
    .video-modal {
        position:fixed; top:0; left:0; right:0; bottom:0;
        background:rgba(0,0,0,0.9); display:none; align-items:center; justify-content:center; z-index:1000; padding:16px;
    }
    .video-modal.active{ display:flex; }
    .video-player-container { width:100%; max-width:1100px; background:#1a1a1a; border-radius:12px; overflow:hidden; position:relative; }
    .close-button { position:absolute; top:12px; right:12px; background:rgba(0,0,0,0.7); border:none; color:white; width:40px; height:40px; border-radius:50%; cursor:pointer; z-index:10; font-size:20px; display:flex; align-items:center; justify-content:center; }
    .video-player { width:100%; height:0; padding-bottom:56.25%; position:relative; }
    .video-player iframe{ position:absolute; top:0; left:0; width:100%; height:100%; border:0; }
    .player-info { padding:16px; }
    .player-title{ font-size:18px; font-weight:600; margin-bottom:8px; }
    .player-stats{ display:flex; justify-content:space-between; color:#aaa; font-size:13px; margin-bottom:12px; }
    .player-actions{ display:flex; gap:12px; margin-bottom:12px; flex-wrap:wrap; }
    .action-button{ background:#373737; border:none; color:white; padding:8px 12px; border-radius:20px; cursor:pointer; display:flex; align-items:center; gap:8px; }

    .player-description{ background:#272727; padding:12px; border-radius:8px; font-size:14px; line-height:1.4; }

    .loading { text-align:center; padding:40px; color:#aaa; }

    /* ------------ MOBILE SPECIFIC ------------ */
    @media (max-width: 900px) {
        /* make sidebar compact */
        .sidebar { width:72px; }
        .main-content { margin-left:72px; padding-top:76px; padding-bottom:120px; } /* top padding for mobile top search */
        .nav-title, .nav-text { display:none; }
        .nav-item { justify-content:center; padding:12px; }
        .nav-icon { margin-right:0; }
    }

    @media (max-width: 768px) {
        /* hide sidebar fully (like mobile app that uses top/bottom nav) */
        .sidebar { transform: translateX(-110%); position:fixed; left:0; top:0; bottom:0; z-index:30; }
        .main-content { margin-left:0; padding-top:70px; padding-left:8px; padding-right:8px; } /* –∑–º–µ–Ω—à–µ–Ω–æ padding –¥–ª—è —â—ñ–ª—å–Ω—ñ—à–æ–≥–æ –≤–∏–≥–ª—è–¥—É */

        /* show mobile top search bar */
        .top-search { display:flex; }

        /* video list like YouTube mobile */
        .video-grid {
            display:flex;
            flex-direction:column;
            gap:8px; /* –∑–º–µ–Ω—à–µ–Ω–æ –≤—ñ–¥—Å—Ç—É–ø –º—ñ–∂ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ */
            margin-bottom:80px;
        }
        .video-card {
            display:flex;
            gap:8px; /* –∑–º–µ–Ω—à–µ–Ω–æ –≤—ñ–¥—Å—Ç—É–ø –º—ñ–∂ thumbnail —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é */
            align-items:flex-start;
            border-radius:10px;
            background:transparent;
            padding:6px 0;
        }
        .thumbnail { width:46%; height:120px; border-radius:8px; flex-shrink:0; } /* —Ç—Ä–æ—Ö–∏ —à–∏—Ä—à–µ –¥–ª—è –∫—Ä–∞—â–æ–≥–æ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –µ–∫—Ä–∞–Ω—É */
        .video-info { padding:0 4px; width:54%; } /* –∑–º–µ–Ω—à–µ–Ω–æ –ø–∞–¥–¥—ñ–Ω–≥ —ñ —à–∏—Ä–∏–Ω–∞ –ø—ñ–¥ –∫–æ–Ω—Ç–µ–Ω—Ç */
        .video-title { font-size:15px; display:-webkit-box; -webkit-line-clamp:2; margin-bottom:6px; }
        .channel-info { margin-top:6px; gap:8px; }
        .channel-name{ font-size:13px; color:#bbb; }
        .video-stats{ font-size:12px; color:#888; margin-left:0; }

        /* adjust modal to be full screen and remove extra margins */
        .video-player-container { border-radius:0; height:100vh; max-width:100%; display:flex; flex-direction:column; }
        .video-player { padding-bottom:56.25%; height:auto; }
        .player-info { overflow:auto; max-height:40vh; padding:12px; }

        /* bottom nav */
        .bottom-nav {
            position:fixed; left:0; right:0; bottom:0; height:56px; background:#0f0f0f; border-top:1px solid #272727; display:flex; z-index:50;
            justify-content:space-around; align-items:center; gap:6px;
        }
        .bottom-nav .nav-item-mobile { display:flex; flex-direction:column; align-items:center; justify-content:center; color:#bbb; font-size:11px; gap:4px; text-decoration:none; }
        .bottom-nav .nav-item-mobile.active { color:white; }
    }

    /* very small screens */
    @media (max-width: 420px) {
        .thumbnail { height:110px; }
        .video-card { gap:8px; }
        .player-title { font-size:16px; }
        .search-input { font-size:15px; }
    }

    /* Accessibility: ensure controls are tappable */
    .search-button, .action-button, .close-button {
        -webkit-tap-highlight-color: rgba(255,255,255,0.05);
        touch-action: manipulation;
    }
</style>
        <nav>
            <div class="nav-item" data-nav="home" style="padding:8px;border-radius:8px;background:#141414;margin-bottom:6px;display:flex;gap:10px;align-items:center;cursor:pointer">
                <div>üè†</div><div style="font-size:14px">–ì–æ–ª–æ–≤–Ω–∞</div>
            </div>
            <div class="nav-item" data-nav="trending" style="padding:8px;border-radius:8px;margin-bottom:6px;display:flex;gap:10px;align-items:center;cursor:pointer">
                <div>üî•</div><div style="font-size:14px">–¢—Ä–µ–Ω–¥–∏</div>
            </div>
            <div class="nav-item" data-nav="subscriptions" style="padding:8px;border-radius:8px;display:flex;gap:10px;align-items:center;cursor:pointer">
                <div>üì∫</div><div style="font-size:14px">–ü—ñ–¥–ø–∏—Å–∫–∏</div>
            </div>
        </nav>
    </aside>

    <!-- Topbar with SINGLE search field (used on desktop + mobile) -->
    <header class="topbar" role="banner">
        <div style="display:flex;align-items:center;gap:12px;margin-right:12px;">
            <div class="logo-icon" style="width:36px;height:36px;font-size:14px">YF</div>
        </div>

        <div class="search-wrap" style="flex:1">
            <!-- –Ñ–î–ò–ù–ï –ø–æ–ª–µ –ø–æ—à—É–∫—É –¥–ª—è —É—Å—ñ—Ö –µ–∫—Ä–∞–Ω—ñ–≤ -->
            <input id="searchInput" class="search-input" type="search" placeholder="–ü–æ—à—É–∫ –≤—ñ–¥–µ–æ..." aria-label="–ü–æ—à—É–∫ –≤—ñ–¥–µ–æ" />
            <button id="searchButton" class="search-button" type="button">–ü–æ—à—É–∫</button>
        </div>
    </header>

    <!-- Main content -->
    <main class="main" id="mainContent" role="main">
        <div class="categories" id="categories">
            <div class="category active">–£—Å—ñ</div>
            <div class="category">–ü–æ–ø—É–ª—è—Ä–Ω–µ</div>
            <div class="category">–ú—É–∑–∏–∫–∞</div>
            <div class="category">–Ü–≥—Ä–∏</div>
            <div class="category">–§—ñ–ª—å–º–∏</div>
            <div class="category">–ù–∞–≤—á–∞–Ω–Ω—è</div>
        </div>

        <section id="videoGrid" class="video-grid" aria-live="polite">
            <div class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö –≤—ñ–¥–µ–æ...</div>
        </section>
    </main>

    <!-- Video modal -->
    <div id="videoModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="player" role="document" id="playerContainer">
            <button class="close" id="closeModal" aria-label="–ó–∞–∫—Ä–∏—Ç–∏">‚úï</button>
            <div class="video-frame" id="videoFrame"></div>
            <div class="player-info" id="playerInfo"></div>
        </div>
    </div>
</div>

<script>
    /******************************************************************
     * –í–∞–∂–ª–∏–≤–µ:
     * –ó–∞–ª–∏—à–∏–≤ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏–π API KEY.
     * –Ø–∫—â–æ —Ö–æ—á–µ—à ‚Äî –∑–∞–º—ñ–Ω–∏ API_KEY –Ω–∞ —Å–≤—ñ–π —Ä–µ–∞–ª—å–Ω–∏–π –∫–ª—é—á.
     ******************************************************************/
    const API_KEY = 'AIzaSyBVqXcayVNDN63l4WpH2HOrTfAqzh3DTXo'; // <-- –∑–∞–ª–∏—à–µ–Ω–æ —è–∫ –ø—Ä–æ—Å–∏–ª–∏
    const MAX_RESULTS = 12;

    // –§–æ–ª–±–µ–∫ ‚Äî sample videos (—â–æ–± UI –ø—Ä–∞—Ü—é–≤–∞–≤ –∫–æ–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π)
    const sampleVideos = [
        {
            id: { videoId: 'dQw4w9WgXcQ' },
            snippet: {
                title: 'Never Gonna Give You Up - Rick Astley',
                description: 'Official video for Rick Astley - Never Gonna Give You Up',
                channelTitle: 'Rick Astley',
                publishedAt: '2009-10-25T06:57:33Z',
                thumbnails: { medium: { url: 'https://img.youtube.com/vi/dQw4w9WgXcQ/mqdefault.jpg' } }
            },
            statistics: { viewCount: '1500000000', likeCount: '12000000' }
        },
        {
            id: { videoId: 'kJQP7kiw5Fk' },
            snippet: {
                title: 'Despacito ft. Daddy Yankee',
                description: 'Luis Fonsi - Despacito ft. Daddy Yankee',
                channelTitle: 'Luis Fonsi',
                publishedAt: '2017-01-13T04:59:31Z',
                thumbnails: { medium: { url: 'https://img.youtube.com/vi/kJQP7kiw5Fk/mqdefault.jpg' } }
            },
            statistics: { viewCount: '8000000000', likeCount: '50000000' }
        },
        {
            id: { videoId: '9bZkp7q19f0' },
            snippet: {
                title: 'PSY - GANGNAM STYLE',
                description: 'PSY - GANGNAM STYLE M/V',
                channelTitle: 'officialpsy',
                publishedAt: '2012-07-15T07:46:32Z',
                thumbnails: { medium: { url: 'https://img.youtube.com/vi/9bZkp7q19f0/mqdefault.jpg' } }
            },
            statistics: { viewCount: '4500000000', likeCount: '23000000' }
        }
    ];

    // DOM –µ–ª–µ–º–µ–Ω—Ç–∏
    const searchInput = document.getElementById('searchInput');
    const searchButton = document.getElementById('searchButton');
    const videoGrid = document.getElementById('videoGrid');
    const videoModal = document.getElementById('videoModal');
    const videoFrame = document.getElementById('videoFrame');
    const playerInfo = document.getElementById('playerInfo');
    const closeModal = document.getElementById('closeModal');
    const categoriesEl = document.getElementById('categories');

    // –ø–æ—Ç–æ—á–Ω—ñ –≤—ñ–¥–µ–æ –≤ UI (–º–∞—Å–∏–≤ –æ–±‚Äô—î–∫—Ç—ñ–≤)
    let currentVideos = [];

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
    document.addEventListener('DOMContentLoaded', () => {
        // –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ pinch/gesture zoom –¥–æ–¥–∞—Ç–∫–æ–≤–æ (–¥–ª—è —Å—Ç–∞—Ä–∏—Ö –±—Ä–∞—É–∑–µ—Ä—ñ–≤)
        window.addEventListener('gesturestart', function (e) { e.preventDefault(); });

        // –ø–æ–¥—ñ—ó –ø–æ—à—É–∫—É
        searchButton.addEventListener('click', onSearch);
        searchInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') onSearch(); });

        // –∑–∞–∫—Ä–∏—Ç–∏ –º–æ–¥–∞–ª–∫—É
        closeModal.addEventListener('click', closePlayer);
        window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closePlayer(); });

        // categories click
        categoriesEl.querySelectorAll('.category').forEach(c => {
            c.addEventListener('click', () => {
                categoriesEl.querySelectorAll('.category').forEach(x => x.classList.remove('active'));
                c.classList.add('active');
                onCategorySelect(c.textContent.trim());
            });
        });

        // –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ñ –≤—ñ–¥–µ–æ
        loadPopularVideos();
    });

    /* ---------- –§–£–ù–ö–¶–Ü–á API / –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è ---------- */

    // –í–∏–∫–æ–Ω—É—î–º–æ –ø–æ—à—É–∫ –≤—ñ–¥–µ–æ (YouTube Search API + Videos.stats)
    async function onSearch() {
        const q = (searchInput.value || '').trim();
        if (!q) return;
        showLoading('–ü–æ—à—É–∫...');
        try {
            // search
            const searchUrl = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(q)}&type=video&maxResults=${MAX_RESULTS}&key=${API_KEY}`;
            const res = await fetch(searchUrl);
            const data = await res.json();
            if (!data.items || data.items.length === 0) {
                // fallback - local samples
                const filtered = sampleVideos.filter(v => v.snippet.title.toLowerCase().includes(q.toLowerCase()));
                displayVideos(filtered.length ? filtered : []);
                return;
            }
            // –æ—Ç—Ä–∏–º—É—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –≤—Å—ñ—Ö videoIds
            const ids = data.items.map(i => i.id.videoId).filter(Boolean).join(',');
            const statsMap = await fetchStatsMap(ids);
            // –∑–±–µ—Ä—ñ–≥–∞—î–º–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —ñ–∑ statistics
            const videos = data.items.map(item => ({
                id: { videoId: item.id.videoId },
                snippet: item.snippet,
                statistics: statsMap[item.id.videoId] || { viewCount: '0', likeCount: '0' }
            }));
            displayVideos(videos);
        } catch (err) {
            console.error('Search error', err);
            showLoading('–ü–æ–º–∏–ª–∫–∞ –ø–æ—à—É–∫—É. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –ª–æ–∫–∞–ª—å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏.');
            displayVideos(sampleVideos);
        }
    }

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ñ –≤—ñ–¥–µ–æ (chart=mostPopular)
    async function loadPopularVideos() {
        showLoading('–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö –≤—ñ–¥–µ–æ...');
        try {
            const url = `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&chart=mostPopular&maxResults=${MAX_RESULTS}&regionCode=UA&key=${API_KEY}`;
            const res = await fetch(url);
            const data = await res.json();
            if (!data.items || data.items.length === 0) {
                displayVideos(sampleVideos);
                return;
            }
            // –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏–º–æ —Ñ–æ—Ä–º–∞—Ç –Ω–∞ —Å–ø—ñ–ª—å–Ω–∏–π —ñ–∑ search results (id.videoId)
            const videos = data.items.map(item => ({
                id: { videoId: item.id },
                snippet: item.snippet,
                statistics: item.statistics || { viewCount: '0', likeCount: '0' }
            }));
            displayVideos(videos);
        } catch (err) {
            console.error('Load popular error', err);
            displayVideos(sampleVideos);
        }
    }

    // –ü–æ–≤–µ—Ä—Ç–∞—î map { videoId: statistics }
    async function fetchStatsMap(idsCommaSeparated) {
        if (!idsCommaSeparated) return {};
        try {
            const url = `https://www.googleapis.com/youtube/v3/videos?part=statistics&id=${idsCommaSeparated}&key=${API_KEY}`;
            const res = await fetch(url);
            const data = await res.json();
            if (!data.items) return {};
            const map = {};
            data.items.forEach(item => {
                map[item.id] = item.statistics || {};
            });
            return map;
        } catch (err) {
            console.error('fetchStatsMap error', err);
            return {};
        }
    }

    /* ---------- UI: –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è/–≤–∑–∞—î–º–æ–¥—ñ—è ---------- */

    function showLoading(text='–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...') {
        videoGrid.innerHTML = `<div class="loading">${escapeHtml(text)}</div>`;
    }

    function displayVideos(videos) {
        currentVideos = videos || [];
        if (!videos || videos.length === 0) {
            videoGrid.innerHTML = `<div class="loading">–í—ñ–¥–µ–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</div>`;
            return;
        }

        // –ó–≥–µ–Ω–µ—Ä—É—î–º–æ —Ä–æ–∑–º—ñ—Ç–∫—É —ñ –ø–æ—Ç—ñ–º –¥–æ–¥–∞–º–æ —Å–ª—É—Ö–∞—á—ñ ‚Äî –ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ inline onclick
        videoGrid.innerHTML = videos.map((v, idx) => {
            const vid = getVideoId(v);
            const thumb = v.snippet.thumbnails?.medium?.url || 'https://via.placeholder.com/320x180/333333/ffffff?text=No+Thumb';
            const title = escapeHtml(v.snippet.title || '–ë–µ–∑ –Ω–∞–∑–≤–∏');
            const channel = escapeHtml(v.snippet.channelTitle || '');
            const views = formatViewCount(v.statistics?.viewCount || '0');
            const timeAgo = formatTimeAgo(v.snippet.publishedAt || '');
            return `
                <article class="video-card" data-videoid="${vid}" role="button" tabindex="0" aria-label="${title}">
                    <div class="thumbnail">
                        <img src="${thumb}" alt="${title}" onerror="this.src='https://via.placeholder.com/320x180/333333/ffffff?text=Thumbnail'">
                        <div class="duration">5:30</div>
                    </div>
                    <div class="video-body">
                        <div class="title">${title}</div>
                        <div class="meta">${channel} ‚Ä¢ ${views} –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤ ‚Ä¢ ${timeAgo}</div>
                    </div>
                </article>
            `;
        }).join('');

        // –î–æ–¥–∞–º–æ —Å–ª—É—Ö–∞—á—ñ –Ω–∞ –∫–æ–∂–Ω—É –∫–∞—Ä—Ç–æ—á–∫—É
        videoGrid.querySelectorAll('.video-card').forEach(card => {
            const vid = card.getAttribute('data-videoid');
            card.addEventListener('click', () => openPlayer(vid));
            card.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') openPlayer(vid); });
        });
    }

    // –û—Ç—Ä–∏–º–∞—Ç–∏ videoId –∑ –æ–±'—î–∫—Ç–∞ (–ø—ñ–¥—Ç—Ä–∏–º—É—î –¥–µ–∫—ñ–ª—å–∫–∞ —Ñ–æ—Ä–º–∞—Ç—ñ–≤)
    function getVideoId(video) {
        if (!video) return '';
        if (video.id && typeof video.id === 'object' && video.id.videoId) return video.id.videoId;
        if (video.id && typeof video.id === 'string') return video.id;
        return '';
    }

    // –í—ñ–¥–∫—Ä–∏—Ç–∏ player modal
    function openPlayer(videoId) {
        if (!videoId) return;
        // –∑–Ω–∞–π–¥–µ–º–æ –≤—ñ–¥–µ–æ –≤ currentVideos (—â–æ–± –ø–æ–∫–∞–∑–∞—Ç–∏ –º–µ—Ç–∞–¥–∞–Ω—ñ)
        const video = currentVideos.find(v => getVideoId(v) === videoId) || null;

        // —Å—Ç–≤–æ—Ä–∏–º–æ iframe
        videoFrame.innerHTML = '';
        const iframe = document.createElement('iframe');
        iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1`;
        iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
        iframe.allowFullscreen = true;
        iframe.setAttribute('loading','lazy');
        videoFrame.appendChild(iframe);

        // –∑–∞–ø–æ–≤–Ω–∏–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—ñ–¥ –≤—ñ–¥–µ–æ
        playerInfo.innerHTML = `
            <div style="font-weight:700;font-size:16px;margin-bottom:8px">${escapeHtml(video?.snippet?.title || '')}</div>
            <div style="color:#aaa;font-size:13px;display:flex;justify-content:space-between;align-items:center">
                <div>${formatViewCount(video?.statistics?.viewCount || '0')} –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤</div>
                <div>${formatTimeAgo(video?.snippet?.publishedAt || '')}</div>
            </div>
            <div class="actions" style="margin-top:12px">
                <button class="btn" id="likeBtn">üëç ${formatCount(video?.statistics?.likeCount || '0')}</button>
                <button class="btn" id="dislikeBtn">üëé –ù–µ –ø–æ–¥–æ–±–∞—î—Ç—å—Å—è</button>
                <button class="btn" id="shareBtn">üì§ –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è</button>
                <button class="btn" id="saveBtn">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
            <div style="background:#181818;padding:10px;border-radius:8px;color:#ddd;font-size:14px;margin-top:8px">${escapeHtml(video?.snippet?.description || '')}</div>
        `;

        // –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª–∫—É
        videoModal.classList.add('open');
        videoModal.setAttribute('aria-hidden','false');
        document.body.style.overflow = 'hidden';

        // –î–æ–¥–∞–º–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –∫–Ω–æ–ø–∫–∞–º (—Å–∏–º—É–ª—è—Ü—ñ—ó)
        const like = document.getElementById('likeBtn');
        const dislike = document.getElementById('dislikeBtn');
        const share = document.getElementById('shareBtn');
        const save = document.getElementById('saveBtn');

        if (like) like.onclick = () => alert('–õ–∞–π–∫! (—Ç—ñ–ª—å–∫–∏ UI ‚Äî —Å–µ—Ä–≤—ñ—Å–Ω—ñ –¥—ñ—ó –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ)');
        if (dislike) dislike.onclick = () => alert('–î–∏–∑–ª–∞–π–∫. (–í —Ä–æ–∑—Ä–æ–±—Ü—ñ)');
        if (share) share.onclick = () => {
            // —Å–ø—Ä–æ–±—É—î–º–æ Web Share API, —è–∫—â–æ –¥–æ—Å—Ç—É–ø–Ω–∏–π
            const url = `https://youtu.be/${videoId}`;
            if (navigator.share) {
                navigator.share({ title: video?.snippet?.title || '', url }).catch(()=>{});
            } else {
                prompt('–°–∫–æ–ø—ñ—é–π—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:', url);
            }
        };
        if (save) save.onclick = () => alert('–ó–±–µ—Ä–µ–∂–µ–Ω–æ –≤ "–ü—ñ–∑–Ω—ñ—à–µ" (UI-—Å–∏–º—É–ª—è—Ü—ñ—è)');
    }

    function closePlayer() {
        videoModal.classList.remove('open');
        videoModal.setAttribute('aria-hidden','true');
        videoFrame.innerHTML = '';
        playerInfo.innerHTML = '';
        document.body.style.overflow = '';
    }

    // –û–±—Ä–æ–±–Ω–∏–∫ –≤–∏–±–æ—Ä—É –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
    function onCategorySelect(cat) {
        if (cat === '–ü–æ–ø—É–ª—è—Ä–Ω–µ') {
            loadPopularVideos();
            return;
        }
        // –ø—Ä–æ—Å—Ç–∏–π –ª–æ–∫–∞–ª—å–Ω–∏–π —Ñ—ñ–ª—å—Ç—Ä –ø–æ –Ω–∞–∑–≤—ñ (–¥–µ–º–æ)
        const q = cat === '–£—Å—ñ' ? '' : cat;
        if (!q) {
            loadPopularVideos();
        } else {
            // –ø—Ä–æ–±—É—î–º–æ –ø–æ—à—É–∫ –ø–æ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –Ω–∞–±–æ—Ä—É –∞–±–æ –∑–∞–≥–∞–ª—å–Ω—ñ –ø–æ—à—É–∫–∏
            searchInput.value = q;
            onSearch();
        }
    }

    /* ---------- –£—Ç–∏–ª—ñ—Ç–∏ ---------- */
    function formatViewCount(views) {
        const n = parseInt(views || '0', 10);
        if (isNaN(n)) return '0';
        if (n >= 1_000_000) return (n / 1_000_000).toFixed(1) + 'M';
        if (n >= 1_000) return (n / 1_000).toFixed(1) + 'K';
        return n.toString();
    }
    function formatCount(c){ return formatViewCount(c); }

    function formatTimeAgo(publishedAt) {
        if (!publishedAt) return '';
        const p = new Date(publishedAt);
        const now = new Date();
        const diff = Math.floor((now - p) / (1000 * 60 * 60 * 24));
        if (diff < 1) return '—Å—å–æ–≥–æ–¥–Ω—ñ';
        if (diff < 30) return `${diff} –¥–Ω—ñ–≤ —Ç–æ–º—É`;
        if (diff < 365) return `${Math.floor(diff / 30)} –º—ñ—Å—è—Ü—ñ–≤ —Ç–æ–º—É`;
        return `${Math.floor(diff / 365)} —Ä–æ–∫—ñ–≤ —Ç–æ–º—É`;
    }

    function escapeHtml(str) {
        if (!str) return '';
        return String(str)
            .replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#039;');
    }
</script>
</body>
</html>
